name: Issue è‡ªåŠ¨å›å¤
on:
  issues:
    types: [opened]  # ä»…ç›‘å¬ Issue æ–°å»ºäº‹ä»¶

permissions:
  issues: write

jobs:
  auto-reply:
    runs-on: ubuntu-latest
    steps:
      - name: æ ¹æ®æ ‡ç­¾å›å¤ Issue
        uses: actions/github-script@v7
        with:
          script: |
            // è·å– Issue ä¿¡æ¯å’Œæ ‡ç­¾åˆ—è¡¨
            const issue = context.payload.issue;
            const issueTitle = issue.title;
            const labels = issue.labels.map(label => label.name.toLowerCase());
            const issueNumber = issue.number;
            const owner = context.repo.owner;
            const repo = context.repo.repo;

            // æ£€æµ‹æ ‡é¢˜æ˜¯å¦åŒ…å«ä¸­æ–‡å­—ç¬¦
            const hasChinese = /[\u4e00-\u9fa5]/.test(issueTitle);

            // å¦‚æœæ ‡é¢˜ä¸åŒ…å«ä¸­æ–‡å­—ç¬¦ï¼Œè·³è¿‡è‡ªåŠ¨å›å¤
            if (!hasChinese) {
              console.log(`Issue #${issueNumber} æ ‡é¢˜ä¸åŒ…å«ä¸­æ–‡å­—ç¬¦ï¼Œè·³è¿‡è‡ªåŠ¨å›å¤`);
              return;
            }

            // å®šä¹‰ä¸åŒæ ‡ç­¾å¯¹åº”çš„å›å¤å†…å®¹
            const replyMap = {
              bug: `ğŸŒŸæ¬¢è¿ç»™AISBench benchmarkæµ‹è¯„å·¥å…·æissueï¼Œæ‚¨å¯ä»¥å…ˆå°è¯•ä»¥ä¸‹é€”å¾„å¯»æ±‚issueçš„è§£å†³æ–¹æ³•ï¼š
              1. åœ¨ [å·¥å…·å†å²issue](https://github.com/AISBench/benchmark/issues/) ä¸­é€šè¿‡é—®é¢˜çš„å…³é”®æ—¥å¿—ç‰‡æ®µæˆ–å…³é”®è¯æ£€ç´¢ç›¸ä¼¼issue
              2. åœ¨ [å®˜æ–¹æ–‡æ¡£](https://ais-bench-benchmark-rf.readthedocs.io/zh_cn/latest/) çš„**æœç´¢æ **ä¸­é€šè¿‡é—®é¢˜çš„å…³é”®æ—¥å¿—ç‰‡æ®µæˆ–å…³é”®è¯æ£€ç´¢
              3. å¯»æ±‚ä»“åº“ç»´æŠ¤è€…çš„å¸®åŠ©ï¼ˆissueè¯„è®ºåŒºä¸­ @SJTUyhï¼‰`,
              question: `ğŸŒŸæ¬¢è¿ç»™AISBench benchmarkæµ‹è¯„å·¥å…·æissueï¼Œæ‚¨å¯ä»¥å…ˆå°è¯•ä»¥ä¸‹é€”å¾„å¯»æ±‚issueçš„è§£å†³æ–¹æ³•ï¼š
              1. åœ¨ [å·¥å…·å†å²issue](https://github.com/AISBench/benchmark/issues/) ä¸­é€šè¿‡é—®é¢˜çš„å…³é”®æ—¥å¿—ç‰‡æ®µæˆ–å…³é”®è¯æ£€ç´¢ç›¸ä¼¼issue
              2. åœ¨ [å®˜æ–¹æ–‡æ¡£](https://ais-bench-benchmark-rf.readthedocs.io/zh_cn/latest/) çš„**æœç´¢æ **ä¸­é€šè¿‡é—®é¢˜çš„å…³é”®æ—¥å¿—ç‰‡æ®µæˆ–å…³é”®è¯æ£€ç´¢
              3. å¯»æ±‚ä»“åº“ç»´æŠ¤è€…çš„å¸®åŠ©ï¼ˆissueè¯„è®ºåŒºä¸­ @SJTUyhï¼‰`,
              enhancement: `ğŸŒŸæ¬¢è¿ç»™AISBench benchmarkæµ‹è¯„å·¥å…·ææ–°ç‰¹æ€§è¯‰æ±‚ï¼Œè¯·ç¡®ä¿åœ¨issueä¸­æè¿°æ¸…æ™°ï¼Œä»¥ä¾¿ä»“åº“ç»´æŠ¤è€…èƒ½å‡†ç¡®ç†è§£æ‚¨çš„è¯‰æ±‚ã€‚å¯¹äºæ–°ç‰¹æ€§è¯‰æ±‚ä»“åº“ç»´æŠ¤è€…ä¸€èˆ¬ä¼šåœ¨3å¤©å†…ç»™æ‚¨ç­”å¤ã€‚`,
              documentation: `ğŸ™æ„Ÿè°¢æ‚¨å‘ç°AISBench benchmarkæµ‹è¯„å·¥å…·çš„æ–‡æ¡£æ¼æ´ï¼Œè¯·ç¡®ä¿åœ¨issueä¸­æè¿°æ¸…æ™°æ–‡æ¡£é—®é¢˜ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½æ›´å¿«ä¿®å¤æ–‡æ¡£ã€‚å¯¹äºæ–‡æ¡£æ¼æ´ä»“åº“ç»´æŠ¤è€…ä¸€èˆ¬ä¼šåœ¨1å¤©å†…ç»™æ‚¨ç­”å¤ã€‚`
            };

            // éå†æ ‡ç­¾ï¼ŒåŒ¹é…å¹¶å‘é€å¯¹åº”å›å¤ï¼ˆå¤šæ ‡ç­¾æ—¶ä¼˜å…ˆæŒ‰ bugâ†’questionâ†’enhancementâ†’documentation é¡ºåºï¼‰
            let replyContent = '';
            if (labels.includes('bug')) {
              replyContent = replyMap.bug;
            } else if (labels.includes('question')) {
              replyContent = replyMap.question;
            } else if (labels.includes('enhancement')) {
              replyContent = replyMap.enhancement;
            } else if (labels.includes('documentation')) {
              replyContent = replyMap.documentation;
            } else {
              replyContent = `ğŸŒŸæ¬¢è¿ç»™AISBench benchmarkæµ‹è¯„å·¥å…·æissueï¼Œæˆ‘ä»¬ä¼šå°½å¿«å¤„ç†æ‚¨çš„è¯‰æ±‚~`;
            }

            // æœ‰åŒ¹é…æ ‡ç­¾æ—¶å‘é€å›å¤
            await github.rest.issues.createComment({
              owner: owner,
              repo: repo,
              issue_number: issueNumber,
              body: replyContent
            });
            console.log(`å·²ä¸º Issue #${issueNumber} å‘é€è‡ªåŠ¨å›å¤ï¼ˆæ ‡ç­¾ï¼š${labels.join(', ')}ï¼‰`);

            // æ ¹æ®æ ‡ç­¾æŒ‡æ´¾Issue
            if (labels.includes('enhancement')) {
              // å½“æ ‡ç­¾ä¸ºenhancementæ—¶ï¼ŒæŒ‡æ´¾ç»™Keithwwaå’ŒSJTUyh
              await github.rest.issues.update({
                owner: owner,
                repo: repo,
                issue_number: issueNumber,
                assignees: ['Keithwwa', 'SJTUyh']
              });
              console.log(`å·²å°† Issue #${issueNumber} æŒ‡æ´¾ç»™ Keithwwa å’Œ SJTUyhï¼ˆenhancementæ ‡ç­¾ï¼‰`);
            } else if (labels.includes('documentation')) {
              // å½“æ ‡ç­¾ä¸ºdocumentationæ—¶ï¼ŒæŒ‡æ´¾ç»™SJTUyh
              await github.rest.issues.update({
                owner: owner,
                repo: repo,
                issue_number: issueNumber,
                assignees: ['SJTUyh']
              });
              console.log(`å·²å°† Issue #${issueNumber} æŒ‡æ´¾ç»™ SJTUyhï¼ˆdocumentationæ ‡ç­¾ï¼‰`);
            }